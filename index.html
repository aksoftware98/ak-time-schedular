<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>04:00 → 04:00 Daily Grid (15-min Blocks)</title>
<style>
  :root{
    --card-bg:rgba(255,255,255,0.65);
    --card-stroke:rgba(0,0,0,0.08);
    --text:#0b1220;
    --muted:#5b6474;
    --bg:linear-gradient(135deg,#e8efff, #f6f9ff 35%, #fefefe);
    --chip:#eef2ff;
    --chip-text:#1f2a5a;
    --now: #111827;
    --past: #dbeafe;
    --future: #f8fafc;
    --grid-stroke: rgba(0,0,0,0.06);
    --shadow: 0 10px 30px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.25);
  }
  @media (prefers-color-scheme: dark){
    :root{
      --card-bg:rgba(22,24,30,0.6);
      --card-stroke:rgba(255,255,255,0.08);
      --text:#e5e7eb;
      --muted:#98a2b3;
      --bg:radial-gradient(1200px 800px at 10% -10%, #1f2937, transparent 60%),
           radial-gradient(1200px 800px at 100% 0%, #0b1020, #0a0f1c 60%);
      --chip:#0f172a;
      --chip-text:#bfdbfe;
      --now:#f9fafb;
      --past:#0b1220;
      --future:#0a0f1c;
      --grid-stroke: rgba(255,255,255,0.08);
      --shadow: 0 10px 30px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05);
    }
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, "Segoe UI Emoji";
    background:var(--bg); color:var(--text);
    padding:24px;
  }
  .app{
    max-width:1200px; margin:0 auto; display:grid; gap:16px;
    grid-template-columns: 1fr;
  }
  .card{
    background:var(--card-bg); border:1px solid var(--card-stroke); border-radius:18px;
    box-shadow:var(--shadow); backdrop-filter: blur(10px);
  }
  .header{
    display:flex; align-items:center; justify-content:space-between; padding:16px 18px; gap:12px;
  }
  .left, .right{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
  .title{font-size:16px; font-weight:700}
  .sub{color:var(--muted); font-size:12px}
  .tz{padding:4px 8px; border-radius:999px; background:var(--chip); color:var(--chip-text); font-weight:600}
  button, .chip{
    border:1px solid var(--card-stroke); background:var(--chip); color:var(--chip-text);
    padding:8px 12px; border-radius:12px; font-weight:600; cursor:pointer;
  }
  button:hover{filter:brightness(0.98)}
  .danger{background:#fee2e2; color:#7f1d1d}
  @media (prefers-color-scheme: dark){
    .danger{background:#4c1d1d; color:#fecaca}
  }

  .legend{padding:8px 12px 16px; display:flex; align-items:center; gap:8px; flex-wrap:wrap}
  .legend .label{font-weight:700; margin-right:6px}
  .cat{
    display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; cursor:pointer;
    border:1px solid var(--card-stroke); background:var(--chip);
  }
  .swatch{width:14px; height:14px; border-radius:4px; border:1px solid rgba(0,0,0,0.15)}
  .cat.active{outline:2px solid currentColor; box-shadow:0 0 0 2px rgba(0,0,0,0.08) inset}

  .grid-wrap{padding:8px 8px 16px}
  .grid{
    display:grid;
    grid-template-columns: 84px repeat(4, minmax(68px, 1fr));
    grid-auto-rows: 36px;
    border:1px solid var(--grid-stroke);
    border-radius:14px; overflow:hidden;
  }
  .hour{
    display:flex; align-items:center; justify-content:flex-end; padding:0 10px; font-variant-numeric: tabular-nums;
    background:linear-gradient(to right, rgba(0,0,0,0.03), transparent);
    border-bottom:1px solid var(--grid-stroke);
  }
  @media (prefers-color-scheme: dark){
    .hour{background:linear-gradient(to right, rgba(255,255,255,0.03), transparent)}
  }
  .block{
    position:relative; border-left:1px solid var(--grid-stroke); border-bottom:1px solid var(--grid-stroke);
    background:var(--future); cursor:pointer; overflow:hidden;
    transition:transform 80ms ease;
  }
  .block:hover{transform:translateY(-1px)}
  .block.past{background:var(--past)}
  .block.future{background:var(--future)}
  .block.current{
    outline:2px solid #60a5fa; z-index:2;
    box-shadow: inset 0 0 0 2px rgba(96,165,250,0.25);
    animation: pulse 2s infinite;
  }
  @keyframes pulse{
    0%{box-shadow: 0 0 0 0 rgba(96,165,250,0.35), inset 0 0 0 2px rgba(96,165,250,0.25)}
    70%{box-shadow: 0 0 0 10px rgba(96,165,250,0), inset 0 0 0 2px rgba(96,165,250,0.25)}
    100%{box-shadow: 0 0 0 0 rgba(96,165,250,0), inset 0 0 0 2px rgba(96,165,250,0.25)}
  }
  .label{
    position:absolute; inset:auto 6px 6px 6px; font-size:11px; line-height:1.15; color:#0b1020; font-weight:700;
    padding:5px 7px; border-radius:8px; background:rgba(255,255,255,0.85); border:1px solid var(--card-stroke);
    box-shadow:inset 0 1px 0 rgba(255,255,255,0.4);
    display:none; pointer-events:none;
  }
  @media (prefers-color-scheme: dark){
    .label{background:rgba(0,0,0,0.35); color:#e5e7eb}
  }
  .block.has-note .label{display:block}

  /* Category fills */
  .fill{position:absolute; inset:0; opacity:0.94}
  .cat-sleep  .fill{background:linear-gradient(180deg,#1f3b73,#162d57)}
  .cat-deep   .fill{background:linear-gradient(180deg,#0e7a5f,#0a5d49)}
  .cat-work   .fill{background:linear-gradient(180deg,#2563eb,#1e3a8a)}
  .cat-study  .fill{background:linear-gradient(180deg,#7c3aed,#4c1d95)}
  .cat-ex     .fill{background:linear-gradient(180deg,#dc2626,#7f1d1d)}
  .cat-admin  .fill{background:linear-gradient(180deg,#6b7280,#374151)}
  .cat-meet   .fill{background:linear-gradient(180deg,#f59e0b,#b45309)}
  .cat-break  .fill{background:linear-gradient(180deg,#06b6d4,#0e7490)}
  .block .timebadge{
    position:absolute; top:4px; left:6px; font-size:10px; padding:2px 6px; border-radius:999px;
    background:rgba(255,255,255,0.86); border:1px solid var(--card-stroke); color:#0b1220; font-variant-numeric: tabular-nums;
  }
  @media (prefers-color-scheme: dark){
    .block .timebadge{background:rgba(0,0,0,0.45); color:#e5e7eb}
  }

  .footer{display:flex; align-items:center; justify-content:space-between; padding:12px 16px; gap:10px}
  .totals{display:flex; gap:8px; flex-wrap:wrap}
  .total-chip{
    display:inline-flex; gap:8px; align-items:center; padding:6px 10px; background:var(--chip);
    border:1px solid var(--card-stroke); border-radius:999px; font-weight:700; color:var(--chip-text)
  }
  .total-chip .swatch{border-color:rgba(0,0,0,0.2)}
  .nowbar{
    height:6px; border-radius:999px; background:linear-gradient(90deg,#60a5fa,#34d399);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.35);
  }
  .controls{display:flex; gap:8px; flex-wrap:wrap; padding:0 12px 12px}
  input[type="file"]{display:none}
</style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="header">
        <div class="left">
          <div>
            <div class="title" id="dayTitle"></div>
            <div class="sub" id="subtitle"></div>
          </div>
          <span class="tz" id="tzBadge"></span>
        </div>
        <div class="right">
          <button id="prevBtn" title="Previous operational day">◀ Prev</button>
          <button id="todayBtn" title="Jump to current operational day">Today</button>
          <button id="nextBtn" title="Next operational day">Next ▶</button>
          <button id="exportBtn" title="Export this day as JSON">Export</button>
          <label class="chip" for="importFile" title="Import JSON plan">Import</label>
          <input id="importFile" type="file" accept="application/json" />
          <button id="printBtn" title="Open print view">Print</button>
          <button id="clearBtn" class="danger" title="Clear all assignments for this day">Clear</button>
        </div>
      </div>
      <div class="legend">
        <span class="label">Select category:</span>
        <!-- legend items injected here -->
      </div>
      <div class="controls">
        <div class="nowbar" id="nowbar" style="width:0%"></div>
      </div>
      <div class="grid-wrap">
        <div class="grid" id="grid"></div>
      </div>
      <div class="footer">
        <div class="totals" id="totals"></div>
        <div class="sub" id="hint">Click to assign. Shift-click to clear. Double-click to add a note. Blocks are 15 minutes.</div>
      </div>
    </div>
  </div>

<script src="script.js"></script>
</body>
</html>
